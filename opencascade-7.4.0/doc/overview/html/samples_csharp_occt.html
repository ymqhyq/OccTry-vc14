<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open CASCADE Technology: OCCT CSharp sample</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="occ_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Open CASCADE Technology
   &#160;<span id="projectnumber">7.4.0.beta</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('samples_csharp_occt.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">OCCT CSharp sample </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This sample demonstrates how to use OCCT libraries in <b>.Net</b> application written using <b>CSharp</b> and <b>Windows Forms</b> or <b>Windows Presentation Foundation</b> (WPF).</p>
<p>The connection between .Net and OCCT (C++) level is provided by proxy library <b>OCCProxy</b>, written in C++/CLI. The proxy library contains a single <em>ref</em> class encapsulating OCCT viewer and providing the functionality to manipulate this viewer and to import / export OCCT shapes from / to several supported CAD file formats (IGES, STEP, BREP).</p>
<p>The sample implements two approaches to the development of a user interface with C#. Both applications provide the same functionality as the standard OCCT Import/Export sample. The first project is called <em>IE_WinForms</em> and uses Windows Forms for GUI. The second application is called <em>IE_WPF_WinForms</em> and uses Windows Presentation Foundation.</p>
<p>Note a few important details:</p>
<ul>
<li>OCCT template class <em>NCollection_Haft</em> is used to encapsulate C++ class into a field of <em>ref</em> class;</li>
<li>It is necessary to explicitly set the target platform for C# assemblies to <em>x86</em> in project <b>Properties - Build</b> to work consistently on 64-bit systems with OCCT libraries built in 32-bit mode;</li>
<li>this sample demonstrates indirect method of wrapping C++ to C# using a manually created proxy library. There is an alternative method of wrapping individual OCCT classes to C# equivalents to make their full API available to a C# user and to let the code be programmed on C# level similarly to C++ one. See the description of <b>OCCT C# Wrapper</b> in <b>Advanced Samples and Tools</b> at <a href="http://www.opencascade.org/support/products/advsamples">http://www.opencascade.org/support/products/advsamples</a></li>
<li>in WPF sample, <b>WinForms</b> control is used to encapsulate OCC viewer since WPF does not provide the necessary interface to embed <a class="elRef" doxygen="C:/builds/OCCT-740_OCCT-740/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_open_gl.html">OpenGl</a> view. Other possible solution could be to render <a class="elRef" doxygen="C:/builds/OCCT-740_OCCT-740/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_open_gl.html">OpenGl</a> scene in an off-screen buffer and to map it to WPF control as an image. That approach would allow using all WPF features to control the OCCT viewer.</li>
</ul>
<p>Run <em>msvc.bat</em> to start MS Visual Studio for building the sample. Note that project files are provided only for VS 2010, you can open them in newer versions of Visual Studio the using automatic converter.</p>
<p>After conversion check option <b>Target framework</b> in the properties of C# projects (tab <b>Application</b>) to make sure that it corresponds to the version set in the properties of C++ projects (e.g. <b>.Net Framework 4.0</b> for VS 2010).</p>
<p>Run <em>run_winforms.bat</em> or <em>run_wpf.bat</em> to launch the corresponding sample.</p>
<p>Note that all batch scripts use the configuration defined in OCCT <em>custom.bat</em> file as default; you can provide arguments specifying VS version, bitness, and mode to override these settings, e.g.: </p><pre class="fragment">&gt; msvc.bat vc10 win64 Debug</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Sep 26 2019 18:39:14 for Open CASCADE Technology by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
